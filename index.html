<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Generador de Facturas</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f4f4f4; }
        
        /* ESTILO DEL FORMULARIO (SOLO SE VE EN PANTALLA) */
        .panel-control { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .fila-form { display: flex; gap: 10px; margin-bottom: 10px; }
        input, select, button { padding: 10px; width: 100%; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #007bff; color: white; font-weight: bold; cursor: pointer; border: none; }
        button:hover { background: #0056b3; }
        label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 0.9em; }

        /* ESTILO DE LA FACTURA (LO QUE SE IMPRIME) */
        #factura-final { background: white; padding: 40px; min-height: 800px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .header { display: flex; justify-content: space-between; margin-bottom: 40px; }
        .mi-empresa h1 { margin: 0; color: #333; }
        .datos-cliente { border: 1px solid #eee; padding: 15px; border-radius: 4px; margin-bottom: 30px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background: #eee; text-align: left; padding: 10px; border-bottom: 2px solid #ddd; }
        td { padding: 10px; border-bottom: 1px solid #eee; }
        .totales { margin-top: 30px; text-align: right; }
        .total-grande { font-size: 1.5em; font-weight: bold; color: #007bff; }

        /* MAGIA PARA IMPRESI√ìN: OCULTA BOTONES Y DEJA SOLO LA FACTURA */
        @media print {
            body { background: white; margin: 0; padding: 0; }
            .panel-control { display: none; }
            #factura-final { box-shadow: none; padding: 0; margin: 0; width: 100%; }
            /* Ocultar elementos del navegador al imprimir */
            @page { margin: 2cm; }
        }
    </style>
</head>
<body>

    <div class="panel-control">
        <h2>üõ†Ô∏è Panel de Control</h2>
        <div class="fila-form">
            <div style="flex: 2;">
                <label>Seleccionar Cliente:</label>
                <select id="selector-cliente" onchange="cargarCliente()">
                    <option value="">-- Elige un cliente --</option>
                    </select>
            </div>
            <div style="flex: 1;">
                <label>N¬∫ Factura:</label>
                <input type="text" id="num-factura" placeholder="Ej: 2025-001">
            </div>
            <div style="flex: 1;">
                <label>Fecha:</label>
                <input type="date" id="fecha-factura">
            </div>
        </div>

        <hr>

        <div class="fila-form">
            <div style="flex: 3;">
                <label>Concepto / Servicio:</label>
                <input type="text" id="input-concepto" placeholder="Ej: Dise√±o Web">
            </div>
            <div style="flex: 1;">
                <label>Precio (‚Ç¨):</label>
                <input type="number" id="input-precio" placeholder="0.00" oninput="calcular()">
            </div>
        </div>

        <button onclick="window.print()">üñ®Ô∏è IMPRIMIR / GUARDAR PDF</button>
    </div>

    <div id="factura-final">
        <div class="header">
            <div class="mi-empresa">
                <h1>MI EMPRESA S.L.</h1> <p>NIF: B-12345678<br>Calle Mi Negocio, 10<br>Valencia, Espa√±a</p>
            </div>
            <div style="text-align: right;">
                <h2 style="color: #777;">FACTURA</h2>
                <p><strong>N¬∫:</strong> <span id="ver-num">---</span></p>
                <p><strong>Fecha:</strong> <span id="ver-fecha">---</span></p>
            </div>
        </div>

        <div class="datos-cliente">
            <strong>FACTURAR A:</strong><br>
            <span id="cliente-nombre">Seleccione un cliente arriba...</span><br>
            <span id="cliente-nif"></span><br>
            <span id="cliente-direccion"></span>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Descripci√≥n</th>
                    <th style="width: 100px; text-align: right;">Importe</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td id="ver-concepto">---</td>
                    <td id="ver-precio" style="text-align: right;">0.00 ‚Ç¨</td>
                </tr>
            </tbody>
        </table>

        <div class="totales">
            <p>Base Imponible: <span id="ver-base">0.00 ‚Ç¨</span></p>
            <p>IVA (21%): <span id="ver-iva">0.00 ‚Ç¨</span></p>
            <p class="total-grande">TOTAL: <span id="ver-total">0.00 ‚Ç¨</span></p>
        </div>
    </div>

    <script>
        // --- 1. AQU√ç EST√Å TU BASE DE DATOS (F√ÅCIL DE EDITAR) ---
        // Solo tienes que a√±adir o cambiar l√≠neas aqu√≠ entre las llaves {}
        const clientes = {
            "c1": { nombre: "Bar Manolo", nif: "B-111111", direccion: "Calle Mayor, 1" },
            "c2": { nombre: "Consultor√≠a L√≥pez", nif: "A-222222", direccion: "Av. Diagonal, 50" },
            "c3": { nombre: "Ana Garc√≠a", nif: "12345678Z", direccion: "Plaza Espa√±a, 3" }
        };

        // Rellenar el desplegable autom√°ticamente al iniciar
        const selector = document.getElementById("selector-cliente");
        for (let key in clientes) {
            let option = document.createElement("option");
            option.value = key;
            option.textContent = clientes[key].nombre;
            selector.appendChild(option);
        }

        // Poner fecha de hoy autom√°tica
        document.getElementById("fecha-factura").valueAsDate = new Date();
        document.getElementById("ver-fecha").innerText = new Date().toLocaleDateString();

        // --- FUNCIONES (LA L√ìGICA) ---

        function cargarCliente() {
            const id = document.getElementById("selector-cliente").value;
            if (id && clientes[id]) {
                document.getElementById("cliente-nombre").innerText = clientes[id].nombre;
                document.getElementById("cliente-nif").innerText = "NIF: " + clientes[id].nif;
                document.getElementById("cliente-direccion").innerText = clientes[id].direccion;
            } else {
                document.getElementById("cliente-nombre").innerText = "Seleccione un cliente...";
                document.getElementById("cliente-nif").innerText = "";
                document.getElementById("cliente-direccion").innerText = "";
            }
        }

        function calcular() {
            // Recoger datos
            let num = document.getElementById("num-factura").value;
            let fecha = document.getElementById("fecha-factura").value; // Formato YYYY-MM-DD
            let concepto = document.getElementById("input-concepto").value;
            let precio = parseFloat(document.getElementById("input-precio").value) || 0;

            // Formatear fecha para que se vea bonita (DD/MM/AAAA)
            if(fecha) {
                let dateObj = new Date(fecha);
                document.getElementById("ver-fecha").innerText = dateObj.toLocaleDateString();
            }

            // Actualizar vista previa
            document.getElementById("ver-num").innerText = num;
            document.getElementById("ver-concepto").innerText = concepto;
            document.getElementById("ver-precio").innerText = precio.toFixed(2) + " ‚Ç¨";

            // C√°lculos matem√°ticos
            let iva = precio * 0.21;
            let total = precio + iva;

            // Mostrar totales
            document.getElementById("ver-base").innerText = precio.toFixed(2) + " ‚Ç¨";
            document.getElementById("ver-iva").innerText = iva.toFixed(2) + " ‚Ç¨";
            document.getElementById("ver-total").innerText = total.toFixed(2) + " ‚Ç¨";
        }

        // Escuchar cambios en los inputs para actualizar en tiempo real
        document.getElementById("num-factura").addEventListener("input", calcular);
        document.getElementById("fecha-factura").addEventListener("change", calcular);
        document.getElementById("input-concepto").addEventListener("input", calcular);
        // El precio ya tiene el evento 'oninput' en el HTML
    </script>
</body>
</html>